{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useState, useEffect } from 'react';\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport View from \"react-native-web/dist/exports/View\";\nimport MapView, { Marker } from 'react-native-maps';\nimport * as Location from 'expo-location';\nimport { parseString } from 'react-native-xml2js';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nexport default function MychatScreen(_ref) {\n  var navigation = _ref.navigation;\n  var _useState = useState(null),\n    _useState2 = _slicedToArray(_useState, 2),\n    region = _useState2[0],\n    setRegion = _useState2[1];\n  var _useState3 = useState([]),\n    _useState4 = _slicedToArray(_useState3, 2),\n    markers = _useState4[0],\n    setMarkers = _useState4[1];\n  var _useState5 = useState(false),\n    _useState6 = _slicedToArray(_useState5, 2),\n    isMarkersVisible = _useState6[0],\n    setIsMarkersVisible = _useState6[1];\n  useEffect(function () {\n    _asyncToGenerator(function* () {\n      var _yield$Location$reque = yield Location.requestForegroundPermissionsAsync(),\n        status = _yield$Location$reque.status;\n      if (status !== 'granted') {\n        alert('Permission to access location was denied');\n        return;\n      }\n      var location = yield Location.getCurrentPositionAsync({});\n      setRegion({\n        latitude: location.coords.latitude,\n        longitude: location.coords.longitude,\n        latitudeDelta: 0.0922,\n        longitudeDelta: 0.0421\n      });\n    })();\n  }, []);\n  var handleButton1Press = function () {\n    var _ref3 = _asyncToGenerator(function* () {\n      if (isMarkersVisible) {\n        setMarkers([]);\n        setIsMarkersVisible(false);\n      } else {\n        yield shelterMarkers();\n        setIsMarkersVisible(true);\n      }\n    });\n    return function handleButton1Press() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n  var handleButton2Press = function () {\n    var _ref4 = _asyncToGenerator(function* () {\n      if (isMarkersVisible) {\n        setMarkers([]);\n        setIsMarkersVisible(false);\n      } else {\n        yield aedMarkers();\n        setIsMarkersVisible(true);\n      }\n    });\n    return function handleButton2Press() {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n  var shelterMarkers = function () {\n    var _ref5 = _asyncToGenerator(function* () {\n      var apiUrl = 'http://apis.data.go.kr/1741000/TsunamiShelter3/getTsunamiShelter1List?ServiceKey=l1%2B1VLJ5U%2BI%2ByRXyHB%2FmTXGXMBz4N7pFSv%2FcjcTFIcXxbUODsvcrXmH7wLoLi3Dplklqs1qMzEiESQ0vnpYB0A%3D%3D&type=json&pageNo=1&numOfRows=10';\n      try {\n        var response = yield fetch(apiUrl);\n        var data = yield response.json();\n        var newMarkers = data.TsunamiShelter[1].row.map(function (item) {\n          return {\n            latitude: parseFloat(item.lat),\n            longitude: parseFloat(item.lon)\n          };\n        });\n        setMarkers(newMarkers);\n      } catch (error) {\n        console.error('Error fetching data:', error);\n      }\n    });\n    return function shelterMarkers() {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n  var aedMarkers = function () {\n    var _ref6 = _asyncToGenerator(function* () {\n      var apiUrl = 'https://apis.data.go.kr/B552657/AEDInfoInqireService/getAedFullDown?serviceKey=l1%2B1VLJ5U%2BI%2ByRXyHB%2FmTXGXMBz4N7pFSv%2FcjcTFIcXxbUODsvcrXmH7wLoLi3Dplklqs1qMzEiESQ0vnpYB0A%3D%3D&pageNo=1&numOfRows=10';\n      try {\n        var response = yield fetch(apiUrl);\n        var data = yield response.text();\n        parseString(data, function (err, result) {\n          if (err) {\n            console.error('XML 파싱 에러:', err);\n            return;\n          }\n          var items = result.response.body[0].items[0].item;\n          var newMarkers = items.map(function (item) {\n            return {\n              latitude: parseFloat(item.wgs84Lat[0]),\n              longitude: parseFloat(item.wgs84Lon[0])\n            };\n          });\n          setMarkers(newMarkers);\n        });\n      } catch (error) {\n        console.error('Error fetching data:', error);\n      }\n    });\n    return function aedMarkers() {\n      return _ref6.apply(this, arguments);\n    };\n  }();\n  if (!region) {\n    return null;\n  }\n  return _jsxs(_Fragment, {\n    children: [_jsxs(View, {\n      style: styles.buttonContainer,\n      children: [_jsx(View, {\n        style: styles.buttonWrapper,\n        children: _jsx(Button, {\n          title: \"\\uB300\\uD53C\\uC18C\",\n          onPress: handleButton1Press\n        })\n      }), _jsx(View, {\n        style: styles.buttonWrapper,\n        children: _jsx(Button, {\n          title: \"\\uC2EC\\uC7A5\\uC81C\\uC138\\uB3D9\\uAE30\",\n          onPress: handleButton2Press\n        })\n      }), _jsx(View, {\n        style: styles.buttonWrapper,\n        children: _jsx(Button, {\n          title: \"\\uBC84\\uD2BC3\",\n          onPress: function onPress() {}\n        })\n      })]\n    }), _jsxs(MapView, {\n      style: {\n        flex: 1\n      },\n      region: region,\n      children: [markers.map(function (marker, index) {\n        return _jsx(Marker, {\n          coordinate: marker\n        }, index);\n      }), region && _jsx(Marker, {\n        coordinate: {\n          latitude: region.latitude,\n          longitude: region.longitude\n        },\n        pinColor: 'yellow'\n      })]\n    })]\n  });\n}\nvar styles = StyleSheet.create({\n  buttonContainer: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginTop: 10,\n    marginBottom: 10,\n    justifyContent: 'flex-start',\n    backgroundColor: 'transparent'\n  },\n  buttonWrapper: {\n    marginLeft: 10\n  }\n});","map":{"version":3,"names":["React","useState","useEffect","StyleSheet","Button","View","MapView","Marker","Location","parseString","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","MychatScreen","_ref","navigation","_useState","_useState2","_slicedToArray","region","setRegion","_useState3","_useState4","markers","setMarkers","_useState5","_useState6","isMarkersVisible","setIsMarkersVisible","_asyncToGenerator","_yield$Location$reque","requestForegroundPermissionsAsync","status","alert","location","getCurrentPositionAsync","latitude","coords","longitude","latitudeDelta","longitudeDelta","handleButton1Press","_ref3","shelterMarkers","apply","arguments","handleButton2Press","_ref4","aedMarkers","_ref5","apiUrl","response","fetch","data","json","newMarkers","TsunamiShelter","row","map","item","parseFloat","lat","lon","error","console","_ref6","text","err","result","items","body","wgs84Lat","wgs84Lon","children","style","styles","buttonContainer","buttonWrapper","title","onPress","flex","marker","index","coordinate","pinColor","create","flexDirection","alignItems","marginTop","marginBottom","justifyContent","backgroundColor","marginLeft"],"sources":["/Users/sinmingyu/Desktop/front/components/Map.js"],"sourcesContent":["import React, {useState, useEffect} from 'react';\nimport {StyleSheet, Button, View} from 'react-native';\nimport MapView, {Marker} from 'react-native-maps';\nimport * as Location from 'expo-location';\nimport {parseString} from 'react-native-xml2js';\n\nexport default function MychatScreen({navigation}) {\n  const [region, setRegion] = useState(null);\n  const [markers, setMarkers] = useState([]);\n  const [isMarkersVisible, setIsMarkersVisible] = useState(false);\n\n  useEffect(() => {\n    (async () => {\n      let {status} = await Location.requestForegroundPermissionsAsync();\n      if (status !== 'granted') {\n        alert('Permission to access location was denied');\n        return;\n      }\n\n      let location = await Location.getCurrentPositionAsync({});\n      setRegion({\n        latitude: location.coords.latitude,\n        longitude: location.coords.longitude,\n        latitudeDelta: 0.0922,\n        longitudeDelta: 0.0421,\n      });\n    })();\n  }, []);\n\n  const handleButton1Press = async () => {\n    if (isMarkersVisible) {\n      setMarkers([]);\n      setIsMarkersVisible(false);\n    } else {\n      await shelterMarkers();\n      setIsMarkersVisible(true);\n    }\n  };\n\n  const handleButton2Press = async () => {\n    if (isMarkersVisible) {\n      setMarkers([]);\n      setIsMarkersVisible(false);\n    } else {\n      await aedMarkers();\n      setIsMarkersVisible(true);\n    }\n  };\n  // 대피소\n  const shelterMarkers = async () => {\n    const apiUrl =\n      'http://apis.data.go.kr/1741000/TsunamiShelter3/getTsunamiShelter1List?ServiceKey=l1%2B1VLJ5U%2BI%2ByRXyHB%2FmTXGXMBz4N7pFSv%2FcjcTFIcXxbUODsvcrXmH7wLoLi3Dplklqs1qMzEiESQ0vnpYB0A%3D%3D&type=json&pageNo=1&numOfRows=10';\n    try {\n      const response = await fetch(apiUrl);\n      const data = await response.json();\n\n      const newMarkers = data.TsunamiShelter[1].row.map(item => ({\n        latitude: parseFloat(item.lat),\n        longitude: parseFloat(item.lon),\n      }));\n\n      setMarkers(newMarkers);\n    } catch (error) {\n      console.error('Error fetching data:', error);\n    }\n  };\n  // 심장제세동기\n  const aedMarkers = async () => {\n    const apiUrl =\n      'https://apis.data.go.kr/B552657/AEDInfoInqireService/getAedFullDown?serviceKey=l1%2B1VLJ5U%2BI%2ByRXyHB%2FmTXGXMBz4N7pFSv%2FcjcTFIcXxbUODsvcrXmH7wLoLi3Dplklqs1qMzEiESQ0vnpYB0A%3D%3D&pageNo=1&numOfRows=10';\n    try {\n      const response = await fetch(apiUrl);\n      const data = await response.text();\n\n      parseString(data, (err, result) => {\n        if (err) {\n          console.error('XML 파싱 에러:', err);\n          return;\n        }\n\n        const items = result.response.body[0].items[0].item;\n        const newMarkers = items.map(item => ({\n          latitude: parseFloat(item.wgs84Lat[0]),\n          longitude: parseFloat(item.wgs84Lon[0]),\n        }));\n\n        setMarkers(newMarkers);\n      });\n    } catch (error) {\n      console.error('Error fetching data:', error);\n    }\n  };\n\n  if (!region) {\n    return null;\n  }\n\n  return (\n    <>\n      <View style={styles.buttonContainer}>\n        <View style={styles.buttonWrapper}>\n          <Button title=\"대피소\" onPress={handleButton1Press} />\n        </View>\n        <View style={styles.buttonWrapper}>\n          <Button title=\"심장제세동기\" onPress={handleButton2Press} />\n        </View>\n        <View style={styles.buttonWrapper}>\n          <Button title=\"버튼3\" onPress={() => {}} />\n        </View>\n      </View>\n      <MapView style={{flex: 1}} region={region}>\n        {markers.map((marker, index) => (\n          <Marker key={index} coordinate={marker} />\n        ))}\n        {region && (\n          //현재 내 위치 노란색으로 마커\n          <Marker\n            coordinate={{\n              latitude: region.latitude,\n              longitude: region.longitude,\n            }}\n            pinColor={'yellow'} // 노란색으로 설정\n          />\n        )}\n      </MapView>\n    </>\n  );\n}\nconst styles = StyleSheet.create({\n  buttonContainer: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginTop: 10,\n    marginBottom: 10,\n    justifyContent: 'flex-start',\n    backgroundColor: 'transparent',\n  },\n  buttonWrapper: {\n    marginLeft: 10,\n  },\n});\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}